<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2023-11-04T23:13:31.678054"><meta name="build-number" content="${buildNumber}">       <title>Building applications | Dapr demo</title><script id="virtual-toc-data" type="application/json">[{"id":"the-applications","level":0,"title":"The applications","anchor":"#the-applications"},{"id":"solution-structure","level":0,"title":"Solution structure","anchor":"#solution-structure"},{"id":"key-terminology","level":0,"title":"Key terminology","anchor":"#key-terminology"},{"id":"daprize-the-applications","level":0,"title":"Daprize the applications","anchor":"#daprize-the-applications"},{"id":"service-to-service","level":0,"title":"Service-to-service","anchor":"#service-to-service"}]</script><script id="topic-shortcuts" type="application/json"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.1.5-b176/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Building applications | Dapr demo"/><meta property="og:description" content=""/><meta property="og:image" content=""/><meta property="og:site_name" content="Dapr demo Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="building-applications.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Building applications | Dapr demo"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "building-applications.html#webpage", "url": "building-applications.html", "name": "Building applications | Dapr demo", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "/#website", "url": "/", "name": "Dapr demo Help" }</script><!-- End Schema.org --> <!-- Mermaid light/dark themes -->  <link rel="stylesheet" type="text/css" href="mermaid.css">  </head>     <body data-id="Building-applications" data-main-title="Building applications" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Developer-experience.md|Developer experience"  >   <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Dapr demo  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Building-applications"  id="Building-applications.md"  >Building applications</h1>  <p id="f3a0de16_7392">To really appreciate the simplicity that dapr provides, let's build an application that uses a lot of the common components that you'd expect from any mildly complex distributed solution.</p><p id="f3a0de16_7393">You may write along if you wish, but I've designed this section to be more of an inspiration to how you can enable certain building blocks and the lessons I've learnt doing so.</p><p id="f3a0de16_7394">The exercise is designed to first write the application code, which allows you to think &quot;how would I normally enable these functionalities?&quot;, and then I'll create a component configuration that goes along with the feature.</p><section class="chapter"><h2 id="the-applications" data-toc="the-applications">The applications</h2><p id="f3a0de16_7395">We'll create two simple, arbitrary applications that communicate with each other through HTTP, gRPC, and event messages.</p><aside class="prompt" data-type="tip" data-title="" id="f3a0de16_7396"><p id="f3a0de16_7397">Note this section is primarily focused on the developer experience. Go to the <a href="azure-containerapp.html" id="f3a0de16_7398" data-tooltip="Start typing here..."  >Azure containerapp</a> if you're interested in deployment to production.</p></aside><p id="f3a0de16_7399">The applications are not meant to model any domain, or, really make any sense. They're made purely to demonstrate dapr capabilities that are prevalent in many distributed architectures and solution designs:</p><ul class="list _ul" id="f3a0de16_7400"    ><li class="list__item" id="f3a0de16_7401"><p>Service-to-service invocation (HTTP and gRPC): how</p></li><li class="list__item" id="f3a0de16_7402"><p>Secrets management: dealing with securely store and retrieve secret values.</p></li><li class="list__item" id="f3a0de16_7403"><p>Pub/sub</p></li><li class="list__item" id="f3a0de16_7404"><p>Configuration management</p></li></ul><p id="f3a0de16_7405">The applications are containerized ASP.NET Core apps built using .NET8 preview with. One is a regular &quot;Empty&quot; ASP.NET Core app, and the other is initialized with the gRPC template.</p><p id="f3a0de16_7406">Each following section demonstrates a certain building block.</p></section><section class="chapter"><h2 id="solution-structure" data-toc="solution-structure">Solution structure</h2><p id="f3a0de16_7407">We have a single .NET solution with two projects (applications):</p><ul class="list _ul" id="f3a0de16_7408"    ><li class="list__item" id="f3a0de16_7409"><p>Users: a web api that exposes a simple HTTP API.</p></li><li class="list__item" id="f3a0de16_7410"><p>Accounts: a gRPC service exposing its method using a proto description file.</p></li></ul><p id="f3a0de16_7411">Our file structure looks like this:</p><div class="code-block" data-lang="plaintext"         >
root/
├──TheSolution.sln
├──.dapr/
│   ├── dapr.yml
│   └── components/
├──src/
│   ├──Accounts/
│   │  ├──.dapr/
│   │  └──Accounts.csproj
│   │
│   └──Users/
│      ├──.dapr/
│      └──Users.csproj
</div><p id="f3a0de16_7413">Notice there's a dot dapr (<code class="code" id="f3a0de16_7414">.dapr</code>) folder in both the solution root and each project.</p><p id="f3a0de16_7415">The solution dot dapr is intended for gathering shared resources and solution wide files, such as the multi app run file <code class="code" id="f3a0de16_7416">dapr.yml</code>.</p></section><section class="chapter"><h2 id="key-terminology" data-toc="key-terminology">Key terminology</h2><p id="f3a0de16_7417">As with anything new, grasping key terminologies often makes the learning curve smoother and enhances understanding. At this point, you're likely familiar with most of the dapr terms, however, take a minute to review the terms below and their meaning.</p><ul class="list _ul" id="f3a0de16_7418"    ><li class="list__item" id="f3a0de16_7419"><p><span class="control" id="f3a0de16_7420">dot dapr (.dapr) folder</span>: a folder which holds dapr specific configurations, and is conventionally also named <code class="code" id="f3a0de16_7421">.dapr</code>. Individual developers may change it's physical name, but should still be referred to as the &quot;dot dapr folder.&quot;</p></li><li class="list__item" id="f3a0de16_7422"><p><span class="control" id="f3a0de16_7423">Component</span>: a building block implementation, such as the &quot;secrets manager component.&quot;</p></li><li class="list__item" id="f3a0de16_7424"><p><span class="control" id="f3a0de16_7425">Project component</span>: a component that is specifically only used in a single application.</p></li><li class="list__item" id="f3a0de16_7426"><p><span class="control" id="f3a0de16_7427">Resource</span>: a broad catagorization of dapr constructs, such as &quot;multi app run file,&quot; &quot;component,&quot; and &quot;dapr API.&quot;</p></li><li class="list__item" id="f3a0de16_7428"><p><span class="control" id="f3a0de16_7429">Shared resource</span>: typically refers to a shared dapr component.</p></li><li class="list__item" id="f3a0de16_7430"><p><span class="control" id="f3a0de16_7431">Sidecar</span>: short for an application-specific &quot;dapr sidecar.&quot;</p></li></ul></section><section class="chapter"><h2 id="daprize-the-applications" data-toc="daprize-the-applications">Daprize the applications</h2><p id="f3a0de16_7432">Let's first daprize the applications. By the way, the &quot;daprize&quot; process is the same for brown-field applications.</p><p id="f3a0de16_7433">The first step is to create</p><div class="code-block" data-lang="yaml"         >
# dapr.yml Multi-App template file
# Use this file to run multiple applications at once.
# Run `dapr run --run-file dapr.yml`
version: 1
common:
  resourcesPath:
    - components # Shared resources - path relative to the dapr.yml file
apps:
  #  - appID: gprcservice
  #    appDirPath: ../src/GrpcApi
  #    appPort: 5118l
  #    daprHTTPPort: 3500
  #    daprGRPCPort: 60001
  #    appProtocol: grpc
  #    daprdLogDestination: console
  #    appLogDestination: console
  #    logLevel: info
  #    command: [&quot;dotnet&quot;, &quot;watch&quot;, &quot;--non-interactive&quot;]
  - appID: httpservice
    appDirPath: ../src/HttpApi
    resourcesPaths:
      - .dapr/components
      - ../../.dapr/components
    appPort: 5214
    daprHTTPPort: 3501
    daprGRPCPort: 60002
    appProtocol: http
    enableApiLogging: true
    daprdLogDestination: console
    appLogDestination: console
    logLevel: debug
#    command: [&quot;dotnet&quot;, &quot;watch&quot;, &quot;--non-interactive&quot;]  

</div></section><section class="chapter"><h2 id="service-to-service" data-toc="service-to-service">Service-to-service</h2></section><div class="last-modified"> Last modified: 04 November 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="getting-started.html">Getting started with dapr</a>   <a class="navigation-links__next" href="defining-components.html">Defining components</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/writerside/apidoc/6.1.5-b176/app.js"></script></body></html>